# クラスの構成

このプロジェクトは、**TCP/UDP通信を用いたチャットシステム** を構成するクラス群で成り立っています。  
サーバーとクライアントでそれぞれの役割を持ち、以下のように分類されます。

---

## 1. サーバープログラム

サーバー側のクラスは、**クライアントの接続管理、リクエスト処理、ルーム管理** などを担当します。

### 1.1 TCPServer

**概要**  
TCP通信を介してクライアントからのリクエストを受け取り、適切な処理を実行します。

| 機能 | 説明 |
|------|------|
| クライアントからの接続受付 | `run` |
| リクエスト処理 | `handle_request` |

### 1.2 UDPServer

**概要**  
UDP通信を介してメッセージを受信し、リレーまたは適切な処理を行います。

| 機能 | 説明 |
|------|------|
| クライアントからのメッセージ受信 | `run` |
| メッセージの処理 | `handle_message` |
| 非アクティブクライアントの削除 | `handle_unactive_client` |

### 1.3 ChatServer

**概要**  
すべてのルームやクライアント情報の管理、リクエストの処理を行います。

| 機能 | 説明 |
|------|------|
| ルームの作成 | `create_room` |
| ルーム一覧の取得 | `get_room_list` |
| ルームへの参加 | `join_room` |
| 非アクティブクライアントの検出 | `detect_unactive_address_list` |

---

## 2. クライアントプログラム

クライアント側のクラスは、**サーバーとの通信、メッセージ送受信、ユーザーインターフェース** を担当します。

### 2.1 TCPClient

**概要**  
TCP通信を介してサーバーにリクエストを送信し、レスポンスを受信します。

| 機能 | 説明 |
|------|------|
| サーバー接続 | `connect` |
| リクエスト送信 | `send_request` |
| サーバー接続の解除 | `disconnect` |

### 2.2 UDPClient

**概要**  
UDP通信を介してメッセージを送受信します。

| 機能 | 説明 |
|------|------|
| メッセージ送信 | `send_message` |
| メッセージ受信 | `receive_message` |
| ソケットの解放 | `close` |

### 2.3 ChatClient

**概要**  
ユーザーインターフェースを提供し、ルームの作成、参加、チャット開始などの操作を処理します。

| 機能 | 説明 |
|------|------|
| ユーザーインターフェース | `play` |
| ルームの作成処理 | `create_room_request` |
| ルーム一覧の取得処理 | `get_room_list_request` |
| ルームへの参加処理 | `join_room_request` |
| チャットインターフェース | `start_chat` |

---

## 3. 共通プロトコル処理

TCP通信および UDP通信のデータ作成・解析を行うクラス群です。

### 3.1 TCPProtocolHandler

**概要**  
TCP通信で使用するデータの作成と解析を行います。

| 機能 | 説明 |
|------|------|
| データ作成 | `make_tcp_data` → クライアントからサーバーへ送信するTCPデータをバイト形式で作成 |
| データ解析 | `parse_data` → サーバーから受信したTCPデータをパースし、辞書形式に変換 |

### 3.2 UDPProtocolHandler

**概要**  
UDP通信で使用するメッセージの作成と解析を行います。

| 機能 | 説明 |
|------|------|
| メッセージ作成 | `make_udp_data` → クライアントやサーバー間でやり取りするメッセージデータをバイト形式で作成 |
| メッセージ解析 | `parse_message` → 受信したUDPメッセージを解析し、辞書形式に変換 |

---

## 4. 構成のポイント

- **サーバーとクライアントを分離**  
  役割ごとに整理し、理解しやすく

- **共通のプロトコル処理を明示**  
  `TCPProtocolHandler` / `UDPProtocolHandler` を独立させる

- **シンプルで視認性の高いレイアウト**  
  見出しの統一、表の活用、適切な間隔の確保

---

このREADMEは、アイコンなしでも直感的に理解できる構成になっています。
